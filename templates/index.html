<!doctype html>
<html lang="en">
<head>
	{% include 'head.html' %}
</head>

<body>
  {% include 'navbar.html' %}

  {% include 'add-modal.html' %}

  <div style="font-size: 16px; font-weight: 300;" class="mt-5 mb-3 ml-2 mr-2" role="main">
    <table id="tableMain" class="table table-striped table-bordered table-sm"
            cellspacing="0">
        <thead>
            <tr>
                {% for item in headerCol %}
                <th class="th-sm font-weighIt-bold">{{ item }}</th>
                {% endfor %}
            </tr>
        </thead>
        <!-- tbody serverside processing -->
    </table>    

    <script defer>
        var dt = null
        $(document).ready(function () {
            dt = $('#tableMain').DataTable({
                serverSide: true,
                    ajax: {
                    url: '/data-source',
                    type: 'POST'
                }
            });
            console.log(dt)
            $('.dataTables_length').addClass('bs-select');
        });

        $('#tableMain').on('click', 'tbody td', function() {

            colNames = {{ headerCol | safe }}
            row = this.parentNode.rowIndex
            clickedCol = this.cellIndex

            /* set existing data */
            for(i in colNames){
                tmpContent = dt.row(row).data()[i]
                inputField = document.getElementById(colNames[i] + "-input")
                if(tmpContent != ""){
                    inputField.value = tmpContent
                }
            }

            /* set delete button */
            deleteButton = document.getElementById("modal-delete-button")
            deleteButton.disabled = false

            /* TODO: assoitated documents */

            /* open modal */
            $('#dataModal').modal("toggle")
        })
    </script>
  </div>
</body>

</html>
